<app-header title="">
    <div actions class="flex gap-2 items-end">
        <p-button
                size="small"
                label="Add Client"
                (onClick)="openDrawer()"
                class="p-button-sm">
        </p-button>
    </div>
</app-header>

<p-table
        [value]="clients"
        [loading]="loading"
        [paginator]="true"
        [rows]="10"
        [showCurrentPageReport]="true"
        currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries">

    <ng-template pTemplate="header">
        <tr>
            <th>Name</th>
            <th>Email</th>
            <th>Mobile</th>
            <th>Address</th>
            <th>Status</th>
            <th style="width: 6rem">Actions</th>
        </tr>
    </ng-template>

    <ng-template pTemplate="body" let-item>
        <tr>
            <td>
                <div>{{ item.firstName }} {{ item.lastName }}</div>
            </td>
            <td>{{ item.email || '-' }}</td>
            <td>{{ item.mobile || '-' }}</td>
            <td>{{ item.address || '-' }}</td>
            <td>
          <span [class]="item.status === 'Y' ? 'text-green-600' : 'text-red-600'">
            {{ item.status === 'Y' ? 'Active' : 'Inactive' }}
          </span>
            </td>
            <td>
                <button 
                  class="p-2 hover:bg-gray-100 rounded-full"
                  (click)="selectedClient = item; menu.toggle($event)">
                  <i class="fa fa-ellipsis-v text-gray-500"></i>
                </button>
                <p-menu [model]="getMenuItems(item)" appendTo="body" #menu [popup]="true">
                  <ng-template pTemplate="item" let-item>
                      <a pRipple class="flex items-center p-menu-item-link">
                          <span [class]="item.icon" [ngClass]="item.styleClass"></span>
                          <span class="ml-2" [ngClass]="item.styleClass">{{ item.label }}</span>
                      </a>
                  </ng-template>
                </p-menu>
            </td>
        </tr>
    </ng-template>
</p-table>

<p-drawer [(visible)]="drawerVisible" [header]="editMode ? 'Edit Client' : 'Add Client'" position="right" [style]="{width: '450px'}">
  <div class="space-y-4">
    <div>
      <label class="block text-sm font-medium mb-2">First Name <span class="text-red-500">*</span></label>
      <input pInputText [(ngModel)]="currentClient.firstName" placeholder="Enter first name" class="w-full" required />
    </div>

    <div>
      <label class="block text-sm font-medium mb-2">Last Name <span class="text-red-500">*</span></label>
      <input pInputText [(ngModel)]="currentClient.lastName" placeholder="Enter last name" class="w-full" required />
    </div>

    <div>
      <label class="block text-sm font-medium mb-2">Email</label>
      <input pInputText [(ngModel)]="currentClient.email" placeholder="Enter email" class="w-full" type="email" />
    </div>

    <div>
      <label class="block text-sm font-medium mb-2">Mobile</label>
      <input pInputText [(ngModel)]="currentClient.mobile" placeholder="Enter mobile number" class="w-full" />
    </div>

    <div>
      <label class="block text-sm font-medium mb-2">Address</label>
      <textarea pInputTextarea [(ngModel)]="currentClient.address" placeholder="Enter address" class="w-full" rows="3"></textarea>
    </div>

    <div>
      <label class="block text-sm font-medium mb-2">Status</label>
      <p-select
        [(ngModel)]="currentClient.status"
        [options]="statusOptions"
        optionLabel="label"
        optionValue="value"
        class="w-full">
      </p-select>
    </div>
    
    <div class="flex gap-2 pt-4">
      <p-button 
        [label]="editMode ? 'Update' : 'Save'" 
        (click)="saveClient()" 
        size="small"></p-button>
      <p-button 
        label="Cancel" 
        severity="secondary" 
        (click)="drawerVisible = false"
        size="small"></p-button>
    </div>
  </div>
</p-drawer>

<p-confirmDialog></p-confirmDialog>